package language

// TypeScript template - exports schemas for use with @xschema/client
// Supports: Type only, Schema only, or both
const TSTemplate = `// Generated by xschema - DO NOT EDIT
// https://xschema.dev/docs
{{- if .Header}}
{{.Header}}
{{- end}}
{{.Imports}}
{{range .Schemas}}
{{- if and .Type (not .Code)}}
export type {{.Name}} = {{.Type}};
{{- else if and .Code (not .Type)}}
export const {{.Name}} = {{.Code}};
{{- else if and .Code .Type}}
export const {{.Name}} = {{.Code}};
export type {{.Name}}Type = {{.Type}};
{{- end}}
{{end}}
export const schemas = { {{range $i, $s := .Schemas}}{{if $i}}, {{end}}{{$s.Name}}{{end}} } as const;

declare module '@xschema/client' {
  interface Register {
    schemas: typeof schemas
  }
}
{{- if .Footer}}
{{.Footer}}
{{- end}}
`

// Python template - generates @overload stubs inline
// Supports: Type only (class), Schema only, or both
const PyTemplate = `# Generated by xschema - DO NOT EDIT
# https://xschema.dev/docs
# pyright: reportOverlappingOverload=false
{{- if .Header}}
{{.Header}}
{{- end}}
from typing import Literal, overload
{{.Imports}}
from xschema import XSchemaBase, XSchemaAdapter
{{range .Schemas}}
{{.Code}}
{{end}}
_schemas: dict[str, type] = { {{range $i, $s := .Schemas}}{{if $i}}, {{end}}"{{$s.Name}}": {{$s.Name}}{{end}} }

class xschema(XSchemaBase):
{{- range .Schemas}}
    {{.Name}} = {{.Name}}
{{- end}}

{{.Footer}}
`

// Go template - self-contained, no runtime package
const GoTemplate = `// Generated by xschema - DO NOT EDIT
// https://xschema.dev/docs
{{.Header}}
{{if .Imports}}

{{.Imports}}
{{end}}
{{range .Schemas}}
{{.Code}}
{{end}}
// Adapter identifies which validation library to use
type Adapter struct {
	Name  string
	Brand string // must be "xschema-adapter"
}

// FromURL registers a schema from a URL (no-op at runtime, used by CLI)
func FromURL(name string, url string, adapter Adapter) {}

// FromFile registers a schema from a file (no-op at runtime, used by CLI)
func FromFile(name string, path string, adapter Adapter) {}
{{- if .Footer}}
{{.Footer}}
{{- end}}
`
